<input type="checkbox" class="custom-control-input" id="customCheck1" checked>



<div class="modal fade" id="ModalWarning" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content">
            <div class="modal-body">


                <div class="text-center">
                    <i style="font-size: 39px;" class="fas fa-exclamation-triangle text-warning"></i>
                    <h4 style="font-weight: bolder;font-size:20px" class="mt-2">¡Advertencia!</h4>
                    <p style="font-size: 18px;" class="mt-3">El registro se eliminará de manera permanente</p>
                    <button (click)="cerrarModalWarning()" type="button" class="btn btn-secondary my-2 mr-2"
                        data-bs-dismiss="modal">Cancelar</button>
                    <button *ngIf="!spinnerWarning" (click)="confirmarEliminacion()" type="button"
                        class="btn btn-primary my-2" data-bs-dismiss="modal">Continuar</button>
                    <button *ngIf="spinnerWarning" class="btn btn-primary" type="button" disabled>
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Espere...
                    </button>
                </div>



            </div>


        </div>
    </div>
</div>



<div class="row ">

    <label class="ml-3"
        style="font-size: 1.3rem ;font-weight: bolder;font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">
        Productos</label>

</div>





<!-- Button trigger modal -->


<div *ngIf="spinner" class="text-center mt-2">

    <div class="spinner-grow text-primary " role="status"></div>

</div>



<div [style.display]="!spinner ? 'block' : 'none'">

    <div class="d-flex justify-content-end">

        <button (click)="abrirModal()" type="button" class="btn btn-primary">
            Nuevo Registro
        </button>

    </div>




    <div class="mt-3">

        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="row-border hover dt-center"
            style="width:100%;text-align:center">

        </table>

    </div>




</div>






<!-- Modal -->
<div class="modal fade" id="exampleModal" data-backdrop="static" data-keyboard="false" tabindex="-1"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 style="font-weight: bolder;" class="modal-title" id="exampleModalLabel">Producto</h5>
                <button (click)="limpiar()" type="button" class="close" dataar-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">



                <div *ngIf="spinnerCargar" class="text-center mt-2">

                    <div class="spinner-border text-primary" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>

                </div>


                <form *ngIf="!spinnerCargar" [formGroup]="productoForm" (ngSubmit)="guardar(productoForm.value)">
                    <div class="modal-body">






                        <div class="row mt-2">












                            <div class="col-sm-4 mt-1">
                                
                                <label for="simpleinput" class="form-label">Codigo</label>
                                <input formControlName="codigo"
                                    [class.is-invalid]="productoForm.get('codigo')!.touched && productoForm.get('codigo')?.invalid"
                                    type="text" class="form-control form-control-sm">
                                <div class="invalid-feedback">*Requerido</div>

                            </div>
                            <div class="col-sm-4 mt-1">

                                <label for="simpleinput" class="form-label">Nombre</label>
                                <textarea formControlName="nombre"
                                    [class.is-invalid]="productoForm.get('nombre')!.touched && productoForm.get('nombre')?.invalid"
                                    class="form-control" id="example-textarea"></textarea>
                                <div class="invalid-feedback">*Requerido</div>


                            </div>


                            <div class="col-sm-4 mt-1">

                                <label for="simpleinput" class="form-label">Descripcion</label>
                                <textarea formControlName="descripcion"
                                    [class.is-invalid]="productoForm.get('descripcion')!.touched && productoForm.get('descripcion')?.invalid"
                                    class="form-control" id="example-textarea"></textarea>
                                <div class="invalid-feedback">*Requerido</div>

                            </div>




                        </div>



                        <div class="row mt-2 ">



                            


                            <div class="col-sm-6 mt-1 mb-3">

                                <div class="row">


                                    <div class="col-sm-6">

                                        <div class="form-group">
                                            <label  for="exampleFormControlSelect1">IVA</label>
                                            <select formControlName="idIva"  class="form-control form-control-sm " id="ivaSelect">
                                                <option [attr.data-valor]="item.valor" value={{item.idIva}} *ngFor="let item of ivasList"
                                                >{{item.nombre}}</option>
                                            
                                            </select>
                                          </div>

                                    </div>

                                    <div class="col-sm-6">

                                        <label for="simpleinput" class="form-label">Precio</label>
                                        <input (keyup)="asignarValor($event.target)"   formControlName="precio"
                                            [class.is-invalid]="productoForm.get('precio')!.touched && productoForm.get('precio')?.invalid"
                                            type="number" class="form-control form-control-sm ">
                                        <div class="invalid-feedback">*Requerido</div>

                                    </div>
                                        
                              


                             

                                </div>
                            

                            </div>


               

                 


                            
                            <div class="col-sm-6 mt-1">

                                <div class="row">


                                   

                                    <div class="col-sm-6">

                                        <label for="simpleinput" class="form-label">IVA</label>
                                        <input   
                                        formControlName="valorIva"
                                            readonly
                                            type="number" class="form-control form-control-sm  ">
                                        <div class="invalid-feedback">*Requerido</div>

                                    </div>

                                    <div class="col-sm-6">

                                        <label for="simpleinput" class="form-label">IVA+Precio</label>
                                        <input   
                                        formControlName="precioIva"
                                            readonly
                                            type="number" class="form-control form-control-sm  ">
                                        <div class="invalid-feedback">*Requerido</div>

                                    </div>



                                </div>

                            </div>



                        </div>

                        <hr>

                        <div class="text-center mb-2">

                            <label style="font-weight: bolder;" >Precios Adicionales</label>
                             

                        </div>

                 
                 
                    <div class="invalid-feedback">*Requerido</div>
                   
                        <div class="row justify-content-center">
                            <div class="input-group input-group-sm  col-sm-6">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-sm">$</span>
                                </div>
                                <input
                                (keyup)="calcularUtilidad()"
                                formControlName="totalIva"
                                [class.is-invalid]="productoForm.get('totalIva')!.touched && productoForm.get('totalIva')?.invalid"
                                type="number" class="form-control mr-2 col-sm " aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                                <!-- <div class="invalid-feedback">*Requerido</div> -->

                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="inputGroup-sizing-sm">%</span>
                                </div>
                                <input
                                (keyup)="calcularUtilidad()"
                                formControlName="porcentaje"
                                [class.is-invalid]="productoForm.get('porcentaje')!.touched && productoForm.get('porcentaje')?.invalid"
                                type="number" class="form-control mr-2 " aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                                <!-- <div class="invalid-feedback">*Requerido</div> -->

                                <div class="input-group-prepend">
                                    <span class="input-group-text col-sm" id="inputGroup-sizing-sm">Utilidad</span>
                                </div>
                                <input readonly formControlName="utilidad"type="number" class="form-control mr-2 col-sm" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                            </div>
                           
                            <i (click)="agregarDetallePrecio()" style="font-size: 19px;cursor:pointer" data-toggle="tooltip" data-placement="bottom" title="Agregar" class="fas fa-plus-circle mt-1"></i>
                            <!-- <i (click)="cancelarDetallePrecio()" style="font-size: 19px;cursor:pointer" data-toggle="tooltip" data-placement="bottom" title="Cancelar" class="fas fa-times-circle mt-1 ml-2"></i> -->
                        </div>

                    
                      

                            <table   *ngIf="this.detallePrecioProductos.length > 0 "  class="table table-bordered mt-4">
                                <thead>
                                  <tr class="text-center">
                                    <th scope="col">#</th>
                                    <th scope="col">Precio</th>
                                    <th scope="col">Porcentaje</th>
                                    <th scope="col">Utilidad</th>
                                    <th scope="col">Opciones</th>
    
                                  </tr>
                                </thead>
                                <tbody *ngFor="let item of detallePrecioProductos let i = index" class="text-center">
                               
                                    <th scope="row">{{ i + 1 }}</th>
                                    <td>{{ item.totalIva }}</td>
                                    <td>{{ item.porcentaje }}%</td>
                                    <td>{{ item.utilidad }}</td>
                                    <td (click)="quitarDetallePrecioProducto(item.id)" style="cursor: pointer;"> <i data-toggle="tooltip" data-placement="bottom" title="Eliminar"  class="fas fa-trash-alt"></i></td>

                                  
                             
                            
                                </tbody>
                              </table>


                     

                    </div>

                    <div class="modal-footer">
                        <button (click)="limpiar()" type="button" class="btn btn-secondary"
                            data-dismiss="modal">Salir</button>
                        <button *ngIf="spinnerGuardar " type="submit" class="btn btn-primary">Guardar</button>
                        <button *ngIf="spinnerEditar" (click)="editar()" type="button"
                            class="btn btn-primary">Editar</button>
                        <button *ngIf="spinnerEspere" class="btn btn-primary" type="button" disabled>
                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                            Espere...
                        </button>
                    </div>

                </form>
            </div>

        </div>
    </div>
</div>